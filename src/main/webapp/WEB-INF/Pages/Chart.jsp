<!DOCTYPE HTML><%@ page contentType="text/html;charset=UTF-8" language="java" %><%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %><html><head>    <title>Home</title>    <meta name="viewport" content="width=device-width, initial-scale=1">    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>    <meta name="keywords" content="Modern Responsive web template, Bootstrap Web Templates, Flat Web Templates, Andriod Compatible web template,Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, SonyErricsson, Motorola web design"/>    <script type="application/x-javascript"> addEventListener("load", function () {        setTimeout(hideURLbar, 0);    }, false);    function hideURLbar() {        window.scrollTo(0, 1);    } </script>    <!-- Bootstrap Core CSS -->    <link href="Css/bootstrap.min.css" rel='stylesheet' type='text/css'/>    <!-- Custom CSS -->    <link href="Css/style.css" rel='stylesheet' type='text/css'/>    <!-- Graph CSS -->    <link href="Css/font-awesome.css" rel="stylesheet">    <!-- jQuery -->    <script src="Js/jquery.min.js"></script>    <!-- Nav CSS -->    <link href="Css/custom.css" rel="stylesheet">    <!-- Metis Menu Plugin JavaScript -->    <script src="Js/metisMenu.min.js"></script>    <script src="Js/custom.js"></script>    <!-- Graph JavaScript -->    <script src="Js/d3.v3.js"></script>    <script src="Js/rickshaw.js"></script>    <script src="Js/model.js"></script>    <script src="http://echarts.baidu.com/build/dist/echarts.js"></script></head><body><div id="wrapper">    <!-- Navigation -->    <nav class="top1 navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0">        <div class="navbar-header">            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">                <span class="sr-only">Toggle navigation</span>                <span class="icon-bar"></span>                <span class="icon-bar"></span>                <span class="icon-bar"></span>            </button>            <a class="navbar-brand" href="#">氡检测平台</a>        </div>        <!-- /.navbar-header -->        <ul class="nav navbar-nav navbar-right">            <li class="dropdown">                <a href="#" class="dropdown-toggle avatar" data-toggle="dropdown">${user.USERNAME}</a>                <ul class="dropdown-menu">                    <li class="m_2"><a href="/user_info"><i class="fa fa-lock"></i>个人资料</a></li>                    <li class="m_2"><a href="/to_logout"><i class="fa fa-lock"></i>登出</a></li>                </ul>            </li>        </ul>        <div class="navbar-default sidebar" role="navigation">            <div class="sidebar-nav navbar-collapse">                <ul class="nav" id="side-menu">                    <li>                        <a href="#" class="active"><i class="fa fa-dashboard fa-fw nav_icon"></i>导航栏</a>                    </li>                    <li>                        <a href="#"><i class="fa fa-laptop nav_icon"></i>台站管理<span class="fa arrow"></span></a>                        <ul class="nav nav-second-level">                            <li>                                <a href="/stationinfo">台站信息</a>                            </li>                        </ul>                        <!-- /.nav-second-level -->                    </li>                    <li>                        <a href="#"><i class="fa fa-laptop nav_icon"></i>用户管理<span class="fa arrow"></span></a>                        <ul class="nav nav-second-level">                            <li>                                <a href="/adduser">注册用户</a>                            </li>                            <li>                                <a href="/user?pagenow=1">查看用户</a>                            </li>                        </ul>                        <!-- /.nav-second-level -->                    </li>                    <li>                        <a href="#"><i class="fa fa-indent nav_icon"></i>仪器管理<span class="fa arrow"></span></a>                        <ul class="nav nav-second-level">                            <li>                                <a href="/addins">注册仪器</a>                            </li>                            <li>                                <a href="/insm?pagenow=1">查看仪器</a>                            </li>                        </ul>                        <!-- /.nav-second-level -->                    </li>                    <li>                        <a href="#"><i class="fa fa-envelope nav_icon"></i>日志管理<span class="fa arrow"></span></a>                        <ul class="nav nav-second-level">                            <li>                                <a href="/OperateLog?pagenow=1">操作日志</a>                            </li>                            <li>                                <a href="compose.html">删除日志</a>                            </li>                        </ul>                        <!-- /.nav-second-level -->                    </li>                    <li>                        <a href="widgets.html"><i class="fa fa-flask nav_icon"></i>数据管理<span                                class="fa arrow"></span></a>                        <ul class="nav nav-second-level">                            <li>                                <a href="/chart">图像处理</a>                            </li>                            <li>                                <a href="/report_table">生成报表</a>                            </li>                        </ul>                    </li>                </ul>            </div>            <!-- /.sidebar-collapse -->        </div>        <!-- /.navbar-static-side -->    </nav>    <div id="page-wrapper">        <div class="graphs">            <form id="postForm">                <span class="label btn_8 label-success">仪器ID</span>                <div class="btn-group">                    <a href="#" title="" class="btn btn-default" data-toggle="dropdown" aria-expanded="false">                        仪器ID                        <i class="fa fa-chevron-down icon_8"></i>                        <div class="ripple-wrapper"></div>                    </a>                    <div class="dropdown-menu float-right disabled">                          <p><input type="checkbox" name="category" value="X421BGKJ0006"/>X421BGKJ0006</p>                        <li>                            <input type="checkbox" name="category" value="X421BGKJ0005"/>X421BGKJ0005                        </li>                        <li>                            <input type="checkbox" name="category" value="X421BGKJ0007"/>X421BGKJ0007                        </li>                        <li>                            <input type="checkbox" name="category" value="X421BGKJ0005"/>X421BGKJ0005                        </li>                        <li>                            <input type="checkbox" name="category" value="X421BGKJ0005"/>X421BGKJ0005                        </li>                        <li><input type="checkbox" name="category" value="X421BGKJ0005"/>X421BGKJ0005</li>                        <li>                            <input type="checkbox" name="category" value="X421BGKJ0005"/>X421BGKJ0005                        </li>                    </div>                </div>                <span class="label btn_8 label-success">时间间隔</span>                <select name="time_slot" id="time_slot" class="btn">                    <option value="60">小时值</option>                    <option value="1">分钟值</option>                    <option value="10">十分钟值</option>                    <option value="second">一秒钟值</option>                </select>                <span class="label btn_8 label-success">处理的值</span>                <select name="deal_value" id="deal_value" class="btn">                    <option value="9130">氡值</option>                    <option value="temperature">温度</option>                    <option value="qiya">气压</option>                    <option value="rh">湿度</option>                </select>                <div class="btn-group"><input type="date" name="date" class="date" ng-model="model.date"></div>                <button class="btn-success btn" id="btn_deal_value" type="button">确定</button>                <input type="time" class="btn stime" ng-model="model.date">-<input type="time" class="btn etime"                                                                                   ng-model="model.date">                <button class="btn-primary btn" id="lack_number" type="button">缺数</button>                <button class="btn-primary btn" id="insert_line" type="button">线性插入</button>            </form>            <div id="main"                 style="width: 1000px;height:500px;-webkit-tap-highlight-color: transparent; user-select: none; cursor: default; background-color: rgba(0, 0, 0, 0);"></div>            <script type="text/javascript">                //用于本页面样式                $(".btn-ID").click(function () {                    $('.tc-15-bubble .tc-15-bubble-top').attr('opacity', 1);                    $('.tc-15-bubble .tc-15-bubble-top').attr('visibility', "visible");                });                // 路径配置                require.config({                    paths: {                        echarts: 'http://echarts.baidu.com/build/dist'                    }                });                // 使用                $(function () {                    require(['echarts', 'echarts/chart/line', 'echarts/chart/bar'], DrawEChart);                });                //定义两个全局变量                var deal_value;                var time_slot;                var n = 1; //用于确定单击的次数判断                function eConsole(param) {                    if (typeof param.seriesIndex == 'undefined') {                        return;                    }                    if (param.type == 'click') {                        var hour;                        var min;                        hour = param.data[0].getHours();                        if (hour <= 9) {                            hour = "0" + hour;                        }                        min = param.data[0].getMinutes();                        if (min <= 9) {                            min = "0" + min;                        }                        if (n == 1) {                            $('.stime').val(hour + ":" + min);                            n = 2;                        } else {                            $('.etime').val(hour + ":" + min);                            n = 1;                        }                        /* switch(time_slot)                         {                         case 10:                         break;                         case 60:                         break;                         }*/                    }                }                function DrawEChart(ec) {                    // 基于准备好的dom，初始化echarts图表                    var myChart = ec.init(document.getElementById('main'));                    myChart.showLoading({                        text: "图表数据正在努力加载...",                    });                    var ecConfig = require('echarts/config');                    myChart.on(ecConfig.EVENT.CLICK, eConsole);                    option = {                        title: {                            text: '时间坐标折线图',                            subtext: '江西南昌地震局'                        },                        tooltip: {                            trigger: 'item',                            //三个参数                            formatter: function (params) {                                var date = new Date(params.value[0]);                                data = date.getFullYear() + '-'                                        + (date.getMonth() + 1) + '-'                                        + date.getDate() + ' '                                        + date.getHours() + ':'                                        + date.getMinutes() + ':'                                        + date.getSeconds();                                return data + '<br/>'                                        + params.value[1];                            }                        },                        toolbox: {                            show: true,                            feature: {                                dataZoom: {                                    show: true,                                    showDetail: true,                                    start: 0,                                    end: 100,                                    realtime: true,                                },                                mark: {show: true},                                dataView: {show: true, readOnly: false},                                restore: {show: true},                                saveAsImage: {show: true}                            }                        },                        dataZoom: {                            show: true,                            start: 0,                            end: 100,                        },                        legend: {                            data: ['series1']                        },                        grid: {                            y2: 80                        },                        xAxis: [                            {                                type: 'time',                            }                        ],                        yAxis: [                            {                                type: 'value',                                boundaryGap: [0, 0],                            }                        ],                        series: [                            {                                name: 'series1',                                type: 'line',                                showAllSymbol: true,                                hoverAnimation: false,                                symbolSize: 1,                                //参数来源                                data: []                            }                        ]                    };                    //通过Ajax获取数据                    $.ajax({                        type: "get",                        async: true, //同步执行                        url: "<%= request.getContextPath()%>/data.json",                        dataType: "json",                        success: function (result) {                            if (result) {                                var data = new Array();                                var date;                                var oneDay;                                date = result.date;                                oneDay = 24;                                if (result.type == 'hour') {                                    for (var i = 0; i < oneDay; i++) {                                        data.push([new Date(date + " " + i + ":00:00"), result.dataDon[i]]);                                    }                                } else if (result.type == 'min') {                                    oneDay = 24 * 60;                                    for (var i = 0; i <= oneDay; i++) {                                        data.push([new Date(date + " " + i + ":00:00"), result.dataDon[i]]);                                    }                                } else if (result.type == 'tmin') {                                    oneDay = 24 * 10;                                    for (var i = 0; i <= oneDay; i++) {                                        data.push([new Date(date + " " + i + ":00:00"), result.dataDon[i]]);                                    }                                }                                option.series[0].data = data;                                myChart.setOption(option);                                myChart.hideLoading();                                myChart.on('dataZoom', function (params) {                                    console.log(params.zoom.start);                                    console.log(params.zoom.start2);                                });                            }                        },                        error: function () {                            alert("图表请求数据失败啦!");                        }                    });                    //chart页面请求数据是触发                    $("#btn_deal_value").click(function () {                        //获取选中的当前类型和时间给全局变量赋值                        deal_value = $('#deal_value');                        time_slot = $('#time_slot');                        $.ajax({                            type: "post",                            url: "/select_value",                            data: $('#postForm').serialize(),                            scriptCharset: 'utf-8',                            success: function (result) {                                var Item = function () {                                    return {                                        name: '',                                        type: 'line',                                        showAllSymbol: true,                                        hoverAnimation: false,                                        symbolSize: 1,                                        //参数来源                                        data: []                                    }                                };                                //series中的每一项为一个item,所有的属性均可以在此处定义                                var legends = [];                                var Series = [];                                //将数据进行解析                                if (result) {                                    for (var i = 0; i < result.length; i++) {                                        var item = new Item();                                        for (var j = 0; j < result[i].datalist.length; j++) {                                            item.data.push([new Date(result[i].datalist[j].time), result[i].datalist[j].value]);                                        }                                        legends.push("series" + i);                                        item.name = "series" + i;                                        Series.push(item);                                    }                                    option.legend.data = legends;                                    option.series = Series; // 设置图表                                    myChart.clear();                                    myChart.setOption(option);                                    myChart.hideLoading();                                }                            },                            error: function () {                                alert('请求失败');//弹出错误信息                            }                        });                    });                    $("#lack_number").click(function () {                        //获取要向后台提交的值                        var stime = $('.stime').val();                        var etime = $('.etime').val();                        alert(etime);                        $.ajax({                            type: "post",//数据发送的方式（post 或者 get）                            url: "/select_value",//要发送的后台地址127.0.0.1                            data: {"deal_value": dealvalue, "time_slot": time_slot, "date": date},//要发送的数据（参数）格式为{'val1':"1","val2":"2"}                            //dataType: "json",//后台处理后返回的数据格式                            scriptCharset: 'utf-8',                            success: function (result) {//ajax请求成功后触发的方法                                if (result) {                                    var data = new Array();                                    var date;                                    var oneDay;                                    if (result.type == 'hour') {                                        date = result.date;                                        oneDay = 24;                                        for (var i = 0; i <= oneDay; i++) {                                            data.push([new Date(date + " " + i + ":00:00"), result.dondata[i]]);                                        }                                    } else if (result.type == 'min') {                                        oneday = 24 * 60;                                        for (var i = 0; i <= oneDay; i++) {                                            data.push([new Date(date + " " + i + ":00:00"), result.dondata[i]]);                                        }                                    } else if (result.type == 'tmin') {                                        oneday = 24 * 10;                                        for (var i = 0; i <= oneDay; i++) {                                            data.push([new Date(date + " " + i + ":00:00"), result.dondata[i]]);                                        }                                    }                                    option.series[0].data = data;                                    myChart.setOption(option);                                    myChart.hideLoading();                                }                            },                            error: function () {//ajax请求失败后触发的方法                                alert('请求失败');//弹出错误信息                            }                        });                    });                    $("#insert_line").click(function () {                        //获取要向后台提交的值                        var stime = $('.stime').val();                        var etime = $('.etime').val();                        alert(etime);                        $.ajax({                            type: "post",//数据发送的方式（post 或者 get）                            url: "/select_value",//要发送的后台地址127.0.0.1                            data: {"deal_value": dealvalue, "time_slot": time_slot, "date": date},                            //dataType: "json",//后台处理后返回的数据格式                            scriptCharset: 'utf-8',                            success: function (result) {//ajax请求成功后触发的方法                                if (result) {                                    var data = new Array();                                    var date;                                    var oneDay;                                    if (result.type == 'hour') {                                        date = result.date;                                        oneDay = 24 * 5;                                        for (var i = 0; i <= oneDay; i++) {                                            data.push([new Date(date + " " + i + ":00:00"), result.dondata[i]]);                                        }                                    } else if (result.type == 'min') {                                        oneday = 24 * 5;                                        for (var i = 0; i <= oneDay; i++) {                                            data.push([new Date(date + " " + i + ":00:00"), result.dondata[i]]);                                        }                                    } else if (result.type == 'tmin') {                                        oneday = 24 * 10;                                        for (var i = 0; i <= oneDay; i++) {                                            data.push([new Date(date + " " + i + ":00:00"), result.dondata[i]]);                                        }                                    }                                    option.series[0].data = data;                                    myChart.setOption(option);                                    myChart.hideLoading();                                }                            },                            error: function () {//ajax请求失败后触发的方法                                alert('请求shi');//弹出错误信息                            }                        });                    });                }                ;            </script>        </div>    </div></div><!-- /#page-wrapper --></div><!-- /#wrapper --><!-- Bootstrap Core JavaScript --><script src="Js/bootstrap.min.js"></script></body></html>